create database recommendation;

use recommendation;

create table user(
    id char(10) not null,
    pwd varchar(20) not null,
    name varchar(20) not null,
    gender varchar(2) not null,
    age integer not null,
    email varchar(30) not null,
    phoneNumber char(11) not null,
    idCardNumber char(18) not null,
    primary key(id)
);

create table manager(
    managerId char(10) not null,
    org varchar(40),
    jobNumber varchar(20) not null,
    primary key(managerId),
    constraint managerUser foreign key(managerId) references user(id)
);

create table investor(
    investorId char(10) not null,
    occupation varchar(40),
    workAddress varchar(40),
    yearlyIncome Integer(12) not null,
    gap Integer not null,
    timeActive Integer check(timeActive in (0,1,2)),
    exceedFlag Integer check(exceedFlag in (0,1)),
    preferenceLevel Integer check(preferenceLevel in (1,2,3,4,5)),
    managerId char(10) not null,
    primary key(investorId),
    constraint investorUser foreign key(investorId) references user(id),
    constraint invertorManager foreign key(managerId) references manager(managerId)
);

create table product(
    productId char(6) not null,
    productCode char(6) not null,
    productName varchar(40) not null,
    generalType varchar(10) not null,
    risk varchar(10) not null,
    interest varchar(10) not null,
    description varchar(1000),
    primary key(productid)
);

create table investment(
    investmentId char(10) not null,
    investorId char(10) not null,
    investableAmount Integer(12) not null,
    investIncomeRatio Decimal(2,2) not null,
    exRedemptionDuration integer not null,
    investmentPurpose varchar(20) not null,
    primary key(investmentId),
    constraint investmentInvestor foreign key(investorId) references investor(investorId)
);

create table investmentDetails(
     investmentId char(10) not null,
     productId char(6) not null,
     primary key(investmentId, productId),
     constraint investmentDetailsInvest foreign key(investmentId) references investment(investmentId),
     constraint investmentDetailsProduct foreign key(productId) references product(productId)
);